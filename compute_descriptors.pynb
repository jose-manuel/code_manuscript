{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Compute Descriptors\n",
    "\n",
    "Computation of descriptors used in Principal Componant Analysis:\n",
    "\n",
    "1. Molecular Descriptors  \n",
    "    - num_heavy_atoms\n",
    "    - molecular_weight\n",
    "    - num_rings\n",
    "    - num_rings_arom\n",
    "    - num_rings_ali\n",
    "    - num_hbd\n",
    "    - num_hba\n",
    "    - slogp\n",
    "    - tpsa\n",
    "    - num_rotatable_bond\n",
    "    - num_atom_oxygen\n",
    "    - num_atom_nitrogen\n",
    "    - ring_size_min\n",
    "    - ring_size_max\n",
    "    - frac_sp3\n",
    "\n",
    "  \n",
    "2. Subset Annotations\n",
    "    - num_lipinski_violations\n",
    "    - num_veber_violations\n",
    "    \n",
    "## Initialization"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-22T12:12:40.982150Z",
     "iopub.status.busy": "2020-11-22T12:12:40.981940Z",
     "iopub.status.idle": "2020-11-22T12:12:41.652636Z",
     "shell.execute_reply": "2020-11-22T12:12:41.652021Z",
     "shell.execute_reply.started": "2020-11-22T12:12:40.982116Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "RDKit WARNING: [13:12:41] Enabling RDKit 2019.09.3 jupyter extensions\n"
     ]
    }
   ],
   "source": [
    "%reload_ext autoreload\n",
    "%autoreload 2\n",
    "\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')\n",
    "\n",
    "# Global Imports\n",
    "from pathlib import Path\n",
    "import sys\n",
    "\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "from rdkit import DataStructs\n",
    "from rdkit.Chem import AllChem as Chem\n",
    "# from rdkit.Chem import Draw\n",
    "from rdkit.Chem.Draw import IPythonConsole\n",
    "\n",
    "# from Contrib.NP_Score import npscorer\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "\n",
    "from IPython.core.interactiveshell import InteractiveShell\n",
    "InteractiveShell.ast_node_interactivity = \"all\"\n",
    "\n",
    "# Project-local Imports\n",
    "PROJECT_DIR = list(Path(\"..\").absolute().parents)[1]\n",
    "sys.path.append(str(PROJECT_DIR))\n",
    "import plt_style\n",
    "import utils as u\n",
    "\n",
    "Path(\"../tmp\").mkdir(exist_ok=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-22T12:12:41.653613Z",
     "iopub.status.busy": "2020-11-22T12:12:41.653446Z",
     "iopub.status.idle": "2020-11-22T12:12:49.252581Z",
     "shell.execute_reply": "2020-11-22T12:12:49.252160Z",
     "shell.execute_reply.started": "2020-11-22T12:12:41.653582Z"
    }
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "RDKit ERROR: [13:12:44] Explicit valence for atom # 26 B, 5, is greater than permitted\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Col0</th>\n",
       "      <th>Chembl_Id</th>\n",
       "      <th>Smiles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>CHEMBL3916495</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c800&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>CHEMBL3917534</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c760&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>CHEMBL3954218</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c620&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>CHEMBL3956388</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c7b0&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>CHEMBL3953960</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c3f0&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>38361</td>\n",
       "      <td>9985</td>\n",
       "      <td>CHEMBL1077644</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414eaddc60&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>38362</td>\n",
       "      <td>9986</td>\n",
       "      <td>CHEMBL1078842</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414eaddcb0&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>38363</td>\n",
       "      <td>9987</td>\n",
       "      <td>CHEMBL1163882</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414eaddd00&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>38364</td>\n",
       "      <td>9988</td>\n",
       "      <td>CHEMBL1087405</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414eaddd50&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>38365</td>\n",
       "      <td>9989</td>\n",
       "      <td>CHEMBL1096140</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414eaddda0&gt;</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>38366 rows Ã— 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Col0      Chembl_Id                                            Smiles\n",
       "0         0  CHEMBL3916495  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c800>\n",
       "1         1  CHEMBL3917534  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c760>\n",
       "2         2  CHEMBL3954218  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c620>\n",
       "3         3  CHEMBL3956388  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c7b0>\n",
       "4         4  CHEMBL3953960  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c3f0>\n",
       "...     ...            ...                                               ...\n",
       "38361  9985  CHEMBL1077644  <rdkit.Chem.rdchem.Mol object at 0x7f414eaddc60>\n",
       "38362  9986  CHEMBL1078842  <rdkit.Chem.rdchem.Mol object at 0x7f414eaddcb0>\n",
       "38363  9987  CHEMBL1163882  <rdkit.Chem.rdchem.Mol object at 0x7f414eaddd00>\n",
       "38364  9988  CHEMBL1087405  <rdkit.Chem.rdchem.Mol object at 0x7f414eaddd50>\n",
       "38365  9989  CHEMBL1096140  <rdkit.Chem.rdchem.Mol object at 0x7f414eaddda0>\n",
       "\n",
       "[38366 rows x 3 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "input_tsv = '../tmp/chembl_np_deglyco_std.tsv'\n",
    "df = u.read_tsv(input_tsv)\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-22T12:12:49.253623Z",
     "iopub.status.busy": "2020-11-22T12:12:49.253420Z",
     "iopub.status.idle": "2020-11-22T12:12:49.271571Z",
     "shell.execute_reply": "2020-11-22T12:12:49.270989Z",
     "shell.execute_reply.started": "2020-11-22T12:12:49.253552Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Col0</th>\n",
       "      <th>Chembl_Id</th>\n",
       "      <th>Smiles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>11966</td>\n",
       "      <td>2638</td>\n",
       "      <td>CHEMBL510343</td>\n",
       "      <td>None</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Col0     Chembl_Id Smiles\n",
       "11966  2638  CHEMBL510343   None"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# display failed molecules\n",
    "df[df['Smiles'].isna()]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-22T12:12:49.272886Z",
     "iopub.status.busy": "2020-11-22T12:12:49.272557Z",
     "iopub.status.idle": "2020-11-22T12:12:49.297550Z",
     "shell.execute_reply": "2020-11-22T12:12:49.296727Z",
     "shell.execute_reply.started": "2020-11-22T12:12:49.272762Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Col0</th>\n",
       "      <th>Chembl_Id</th>\n",
       "      <th>Smiles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>CHEMBL3916495</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c800&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>CHEMBL3917534</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c760&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>CHEMBL3954218</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c620&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>CHEMBL3956388</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c7b0&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>CHEMBL3953960</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c3f0&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>95</td>\n",
       "      <td>100</td>\n",
       "      <td>CHEMBL3971406</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed60800&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>96</td>\n",
       "      <td>101</td>\n",
       "      <td>CHEMBL3972839</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed60850&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>97</td>\n",
       "      <td>102</td>\n",
       "      <td>CHEMBL3971802</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed608a0&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>98</td>\n",
       "      <td>103</td>\n",
       "      <td>CHEMBL3972383</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed608f0&gt;</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>99</td>\n",
       "      <td>104</td>\n",
       "      <td>CHEMBL3974631</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed60940&gt;</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows Ã— 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Col0      Chembl_Id                                            Smiles\n",
       "0      0  CHEMBL3916495  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c800>\n",
       "1      1  CHEMBL3917534  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c760>\n",
       "2      2  CHEMBL3954218  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c620>\n",
       "3      3  CHEMBL3956388  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c7b0>\n",
       "4      4  CHEMBL3953960  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c3f0>\n",
       "..   ...            ...                                               ...\n",
       "95   100  CHEMBL3971406  <rdkit.Chem.rdchem.Mol object at 0x7f414ed60800>\n",
       "96   101  CHEMBL3972839  <rdkit.Chem.rdchem.Mol object at 0x7f414ed60850>\n",
       "97   102  CHEMBL3971802  <rdkit.Chem.rdchem.Mol object at 0x7f414ed608a0>\n",
       "98   103  CHEMBL3972383  <rdkit.Chem.rdchem.Mol object at 0x7f414ed608f0>\n",
       "99   104  CHEMBL3974631  <rdkit.Chem.rdchem.Mol object at 0x7f414ed60940>\n",
       "\n",
       "[100 rows x 3 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# filter out failed molecules\n",
    "df = df[~df['Smiles'].isna()].head(100)\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Compute descriptors"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "execution": {
     "iopub.execute_input": "2020-11-22T12:12:49.299076Z",
     "iopub.status.busy": "2020-11-22T12:12:49.298755Z",
     "iopub.status.idle": "2020-11-22T12:12:49.569261Z",
     "shell.execute_reply": "2020-11-22T12:12:49.568741Z",
     "shell.execute_reply.started": "2020-11-22T12:12:49.299024Z"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Col0</th>\n",
       "      <th>Chembl_Id</th>\n",
       "      <th>Smiles</th>\n",
       "      <th>num_heavy_atoms</th>\n",
       "      <th>molecular_weight</th>\n",
       "      <th>num_rings</th>\n",
       "      <th>num_rings_arom</th>\n",
       "      <th>num_rings_ali</th>\n",
       "      <th>num_hbd</th>\n",
       "      <th>num_hba</th>\n",
       "      <th>slogp</th>\n",
       "      <th>tpsa</th>\n",
       "      <th>num_rotatable_bond</th>\n",
       "      <th>num_atom_oxygen</th>\n",
       "      <th>num_atom_nitrogen</th>\n",
       "      <th>ring_size_min</th>\n",
       "      <th>ring_size_max</th>\n",
       "      <th>frac_sp3</th>\n",
       "      <th>num_lipinski_violations</th>\n",
       "      <th>num_veber_violations</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>CHEMBL3916495</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c800&gt;</td>\n",
       "      <td>36.0</td>\n",
       "      <td>504.2723</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>4.3079</td>\n",
       "      <td>105.20</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.714286</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>CHEMBL3917534</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c760&gt;</td>\n",
       "      <td>50.0</td>\n",
       "      <td>686.4183</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.7560</td>\n",
       "      <td>132.13</td>\n",
       "      <td>15.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.511628</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>CHEMBL3954218</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c620&gt;</td>\n",
       "      <td>38.0</td>\n",
       "      <td>526.2567</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>3.1975</td>\n",
       "      <td>114.96</td>\n",
       "      <td>3.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.766667</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>3</td>\n",
       "      <td>3</td>\n",
       "      <td>CHEMBL3956388</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c7b0&gt;</td>\n",
       "      <td>40.0</td>\n",
       "      <td>552.3815</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>7.6352</td>\n",
       "      <td>80.67</td>\n",
       "      <td>9.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.685714</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>4</td>\n",
       "      <td>4</td>\n",
       "      <td>CHEMBL3953960</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414d94c3f0&gt;</td>\n",
       "      <td>22.0</td>\n",
       "      <td>619.6469</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>7.3086</td>\n",
       "      <td>27.69</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.142857</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>95</td>\n",
       "      <td>100</td>\n",
       "      <td>CHEMBL3971406</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed60800&gt;</td>\n",
       "      <td>34.0</td>\n",
       "      <td>464.1835</td>\n",
       "      <td>4.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>5.2843</td>\n",
       "      <td>114.04</td>\n",
       "      <td>3.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.370370</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>96</td>\n",
       "      <td>101</td>\n",
       "      <td>CHEMBL3972839</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed60850&gt;</td>\n",
       "      <td>35.0</td>\n",
       "      <td>484.3916</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>7.5680</td>\n",
       "      <td>46.53</td>\n",
       "      <td>6.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.906250</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>97</td>\n",
       "      <td>102</td>\n",
       "      <td>CHEMBL3971802</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed608a0&gt;</td>\n",
       "      <td>31.0</td>\n",
       "      <td>426.2770</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>6.6587</td>\n",
       "      <td>52.60</td>\n",
       "      <td>6.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.629630</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>98</td>\n",
       "      <td>103</td>\n",
       "      <td>CHEMBL3972383</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed608f0&gt;</td>\n",
       "      <td>43.0</td>\n",
       "      <td>602.3289</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>-1.2452</td>\n",
       "      <td>268.71</td>\n",
       "      <td>14.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>0.518519</td>\n",
       "      <td>3.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <td>99</td>\n",
       "      <td>104</td>\n",
       "      <td>CHEMBL3974631</td>\n",
       "      <td>&lt;rdkit.Chem.rdchem.Mol object at 0x7f414ed60940&gt;</td>\n",
       "      <td>33.0</td>\n",
       "      <td>449.2930</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.5729</td>\n",
       "      <td>69.56</td>\n",
       "      <td>5.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>0.344828</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>100 rows Ã— 20 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    Col0      Chembl_Id                                            Smiles  \\\n",
       "0      0  CHEMBL3916495  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c800>   \n",
       "1      1  CHEMBL3917534  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c760>   \n",
       "2      2  CHEMBL3954218  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c620>   \n",
       "3      3  CHEMBL3956388  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c7b0>   \n",
       "4      4  CHEMBL3953960  <rdkit.Chem.rdchem.Mol object at 0x7f414d94c3f0>   \n",
       "..   ...            ...                                               ...   \n",
       "95   100  CHEMBL3971406  <rdkit.Chem.rdchem.Mol object at 0x7f414ed60800>   \n",
       "96   101  CHEMBL3972839  <rdkit.Chem.rdchem.Mol object at 0x7f414ed60850>   \n",
       "97   102  CHEMBL3971802  <rdkit.Chem.rdchem.Mol object at 0x7f414ed608a0>   \n",
       "98   103  CHEMBL3972383  <rdkit.Chem.rdchem.Mol object at 0x7f414ed608f0>   \n",
       "99   104  CHEMBL3974631  <rdkit.Chem.rdchem.Mol object at 0x7f414ed60940>   \n",
       "\n",
       "    num_heavy_atoms  molecular_weight  num_rings  num_rings_arom  \\\n",
       "0              36.0          504.2723        3.0             0.0   \n",
       "1              50.0          686.4183        3.0             1.0   \n",
       "2              38.0          526.2567        7.0             0.0   \n",
       "3              40.0          552.3815        3.0             0.0   \n",
       "4              22.0          619.6469        2.0             2.0   \n",
       "..              ...               ...        ...             ...   \n",
       "95             34.0          464.1835        4.0             2.0   \n",
       "96             35.0          484.3916        5.0             0.0   \n",
       "97             31.0          426.2770        3.0             1.0   \n",
       "98             43.0          602.3289        2.0             1.0   \n",
       "99             33.0          449.2930        1.0             0.0   \n",
       "\n",
       "    num_rings_ali  num_hbd  num_hba   slogp    tpsa  num_rotatable_bond  \\\n",
       "0             3.0      0.0      8.0  4.3079  105.20                 8.0   \n",
       "1             2.0      4.0      7.0  9.7560  132.13                15.0   \n",
       "2             7.0      1.0      8.0  3.1975  114.96                 3.0   \n",
       "3             3.0      1.0      5.0  7.6352   80.67                 9.0   \n",
       "4             0.0      0.0      3.0  7.3086   27.69                 4.0   \n",
       "..            ...      ...      ...     ...     ...                 ...   \n",
       "95            2.0      2.0      7.0  5.2843  114.04                 3.0   \n",
       "96            5.0      1.0      3.0  7.5680   46.53                 6.0   \n",
       "97            2.0      0.0      4.0  6.6587   52.60                 6.0   \n",
       "98            1.0     12.0     16.0 -1.2452  268.71                14.0   \n",
       "99            1.0      3.0      4.0  5.5729   69.56                 5.0   \n",
       "\n",
       "    num_atom_oxygen  num_atom_nitrogen  ring_size_min  ring_size_max  \\\n",
       "0               8.0                0.0            6.0            6.0   \n",
       "1               7.0                0.0            6.0            6.0   \n",
       "2               8.0                0.0            3.0            6.0   \n",
       "3               5.0                0.0            6.0            6.0   \n",
       "4               3.0                0.0            6.0            6.0   \n",
       "..              ...                ...            ...            ...   \n",
       "95              7.0                0.0            6.0            6.0   \n",
       "96              3.0                0.0            3.0            6.0   \n",
       "97              4.0                0.0            6.0            6.0   \n",
       "98              6.0               10.0            6.0            6.0   \n",
       "99              3.0                1.0           20.0           20.0   \n",
       "\n",
       "    frac_sp3  num_lipinski_violations  num_veber_violations  \n",
       "0   0.714286                      1.0                   1.0  \n",
       "1   0.511628                      2.0                   3.0  \n",
       "2   0.766667                      1.0                   1.0  \n",
       "3   0.685714                      2.0                   2.0  \n",
       "4   0.142857                      2.0                   2.0  \n",
       "..       ...                      ...                   ...  \n",
       "95  0.370370                      1.0                   1.0  \n",
       "96  0.906250                      1.0                   1.0  \n",
       "97  0.629630                      1.0                   1.0  \n",
       "98  0.518519                      3.0                   5.0  \n",
       "99  0.344828                      1.0                   1.0  \n",
       "\n",
       "[100 rows x 20 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df = u.compute_descriptors_df(df, smiles_col='Smiles')\n",
    "df"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
